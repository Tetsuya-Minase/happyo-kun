# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä»•æ§˜æ›¸: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ»ã‚¹ãƒ©ã‚¤ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### 1.1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
- **åç§°**: happyo-kun (ç™ºè¡¨ãã‚“)
- **ãƒªãƒã‚¸ãƒˆãƒª**: `github.com/yourusername/happyo-kun`
- **èª¬æ˜**: ğŸ¯ Your presentation buddy - Interactive slides with live coding powered by Slidev & Cloudflare

### 1.2. ç›®çš„
æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€`Slidev` ã‚’ç”¨ã„ã¦ Markdown ã‹ã‚‰ç”Ÿæˆã•ã‚Œã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ã€Cloudflare ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’é€šã˜ã¦é«˜é€Ÿã‹ã¤å®‰å…¨ã«é…ä¿¡ã™ã‚‹ Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¾ã™ã€‚

### 1.3. ã‚³ã‚¢æ©Ÿèƒ½
* Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ƒã«ã—ãŸã‚¹ãƒ©ã‚¤ãƒ‰ã®é™çš„ã‚µã‚¤ãƒˆç”Ÿæˆ
* ã‚¹ãƒ©ã‚¤ãƒ‰ä¸Šã§ã® JavaScript å®Ÿè¡Œã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ¢ï¼ˆCSS ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç·¨é›†ï¼‰
* ã‚¹ãƒ©ã‚¤ãƒ‰ã‹ã‚‰ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ API ã¸ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
* ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ CSSãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ©Ÿèƒ½

-----

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | å½¹å‰²ãƒ»é¸å®šç†ç”± |
| :--- | :--- | :--- |
| **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰** | Slidev | Markdown ã‹ã‚‰ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹ã‚³ã‚¢ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚Vue.js ãƒ™ãƒ¼ã‚¹ã€‚ |
| **ã‚¤ãƒ³ãƒ•ãƒ©** | Cloudflare Pages | é™çš„ã‚µã‚¤ãƒˆã®ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã¨ CDN é…ä¿¡ã€‚GitHub ã¨é€£æºã—ãŸè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã€‚ |
| **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (API)** | Cloudflare Workers (Pages Functions) | ä½é…å»¶ãªã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ APIã€‚ã‚¹ãƒ©ã‚¤ãƒ‰ã¨åŒä¸€ãƒ‰ãƒ¡ã‚¤ãƒ³ã§æä¾›ã— CORS ã‚’å›é¿ã€‚ |
| **è¨€èª** | TypeScript | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆSlidevå†…ï¼‰ãŠã‚ˆã³ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (Workers) ã®é–‹ç™ºè¨€èªã€‚ |
| **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†** | pnpm (with Workspaces) | ãƒ¢ãƒãƒ¬ãƒæ§‹æˆã‚’åŠ¹ç‡çš„ã«ç®¡ç†ã€‚ |
| **CI/CD** | GitHub & Cloudflare Pages | GitHub ã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã€ãƒ“ãƒ«ãƒ‰ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è‡ªå‹•å®Ÿè¡Œã€‚ |

-----

## 3. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 3.1. ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ Cloudflare ã®ã‚¨ãƒƒã‚¸ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’çµŒç”±ã—ã€é™çš„ãªã‚¹ãƒ©ã‚¤ãƒ‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ (Pages) ã¾ãŸã¯ API (Workers) ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚

```mermaid
graph TD
    A[User Browser] --> B{Cloudflare Edge Network};
    B --> C[Cloudflare Pages (Static Slides)];
    B --> D[Cloudflare Workers (API)];

    subgraph GitHub Repository (Monorepo)
        E[/apps/slide]
        F[/apps/shared]
    end

    G[GitHub Actions] --> B;
    E --> G;
    F --> G;

    style C fill:#f9f,stroke:#333,stroke-width:2px
    style D fill:#ccf,stroke:#333,stroke-width:2px
```

### 3.2. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

`pnpm workspaces` ã‚’åˆ©ç”¨ã—ãŸãƒ¢ãƒãƒ¬ãƒæ§‹æˆã‚’æ¡ç”¨ã—ã¾ã™ã€‚

```plaintext
happyo-kun/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ slide/                    # Slidev ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”œâ”€â”€ slides.md            # ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ©ã‚¤ãƒ‰
â”‚   â”‚   â”œâ”€â”€ components/          # Vueã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ CssPlayground.vue
â”‚   â”‚   â”‚   â””â”€â”€ ApiDemo.vue
â”‚   â”‚   â”œâ”€â”€ functions/           # Cloudflare Pages Functions
â”‚   â”‚   â”‚   â”œâ”€â”€ _middleware.ts  # å…±é€šãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”‚   â”‚   â””â”€â”€ api/
â”‚   â”‚   â”‚       â”œâ”€â”€ hello.ts
â”‚   â”‚   â”‚       â””â”€â”€ css.ts
â”‚   â”‚   â”œâ”€â”€ public/              # é™çš„ã‚¢ã‚»ãƒƒãƒˆ
â”‚   â”‚   â”œâ”€â”€ styles/              # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
â”‚   â”‚   â”‚   â””â”€â”€ main.css
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ vite.config.ts       # Viteè¨­å®š
â”‚   â”‚   â”œâ”€â”€ .env.example         # ç’°å¢ƒå¤‰æ•°ã‚µãƒ³ãƒ—ãƒ«
â”‚   â”‚   â””â”€â”€ tsconfig.json        # TypeScriptè¨­å®š
â”‚   â””â”€â”€ shared/                  # å…±æœ‰ã‚³ãƒ¼ãƒ‰
â”‚       â”œâ”€â”€ types/               # å‹å®šç¾©
â”‚       â”‚   â””â”€â”€ index.ts
â”‚       â”œâ”€â”€ utils/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚       â”‚   â””â”€â”€ api.ts
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ package.json                 # ãƒ«ãƒ¼ãƒˆpackage.json
â”œâ”€â”€ pnpm-workspace.yaml
â”œâ”€â”€ pnpm-lock.yaml
â”œâ”€â”€ .gitignore
â”œâ”€â”€ LICENSE                      # MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹
â”œâ”€â”€ LICENSE-CONTENT             # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
â”œâ”€â”€ README.md
â””â”€â”€ .github/
    â””â”€â”€ workflows/
        â””â”€â”€ deploy.yml           # GitHub Actionsè¨­å®š
```

**æ³¨**: Cloudflare Pages Functions ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã€APIã‚³ãƒ¼ãƒ‰ã¯ `/apps/slide/functions` ã®ã‚ˆã†ã«ã€Pages ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã«é…ç½®ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚

-----

## 4. æ©Ÿèƒ½è¦ä»¶

### FR-1: ã‚¹ãƒ©ã‚¤ãƒ‰è¡¨ç¤ºæ©Ÿèƒ½

* **ä»•æ§˜**: `/apps/slide/slides.md` ã«è¨˜è¿°ã•ã‚ŒãŸ Markdown ã‚’å…ƒã«ã€`slidev build` ã‚³ãƒãƒ³ãƒ‰ã§ HTML, CSS, JS ã‚’å«ã‚€é™çš„ã‚µã‚¤ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã€‚
* **å—ã‘å…¥ã‚ŒåŸºæº–**:
    * ç”Ÿæˆã•ã‚ŒãŸã‚µã‚¤ãƒˆãŒãƒ–ãƒ©ã‚¦ã‚¶ã§æ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨
    * ã‚¹ãƒ©ã‚¤ãƒ‰ã®ãƒšãƒ¼ã‚¸é·ç§»ãŒæ©Ÿèƒ½ã™ã‚‹ã“ã¨
    * ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼ˆSpace, Arrow Keysï¼‰ãŒå‹•ä½œã™ã‚‹ã“ã¨

### FR-2: CSSãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ©Ÿèƒ½

* **ä»•æ§˜**: ã‚¹ãƒ©ã‚¤ãƒ‰å†…ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«CSSã‚’ç·¨é›†ãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ãã‚‹æ©Ÿèƒ½
* **è¦æ±‚äº‹é …**:
    * ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã§CSSã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›
    * iframeã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
    * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆCSSãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æä¾›
    * ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½
    * ä¿å­˜æ©Ÿèƒ½ï¼ˆAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆçµŒç”±ï¼‰
* **å—ã‘å…¥ã‚ŒåŸºæº–**:
    * CSSå…¥åŠ›å¾Œ300msä»¥å†…ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒæ›´æ–°ã•ã‚Œã‚‹ã“ã¨
    * XSSæ”»æ’ƒã‚’é˜²ããŸã‚ã®ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã“ã¨
    * ä¿å­˜ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§APIã«é€ä¿¡ã•ã‚Œã‚‹ã“ã¨

### FR-3: API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ©Ÿèƒ½

* **ä»•æ§˜**: ä»¥ä¸‹ã®ä»•æ§˜ã§ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ã“ã¨ã€‚

#### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ1: Hello API
* **ãƒ‘ã‚¹**: `/api/hello`
* **ãƒ¡ã‚½ãƒƒãƒ‰**: `GET`
* **ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**: `name` (string, optional, default: "World")
* **æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ (200 OK)**:
  ```json
  {
    "message": "Hello, {name}!",
    "timestamp": 1234567890
  }
  ```

#### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ2: CSSä¿å­˜API
* **ãƒ‘ã‚¹**: `/api/css`
* **ãƒ¡ã‚½ãƒƒãƒ‰**: `POST`
* **ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£**:
  ```json
  {
    "css": "/* CSS code */",
    "timestamp": 1234567890
  }
  ```
* **æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ (200 OK)**:
  ```json
  {
    "success": true,
    "id": "uuid-string",
    "savedAt": 1234567890
  }
  ```

### FR-4: ã‚¹ãƒ©ã‚¤ãƒ‰ã‹ã‚‰ã® API é€£æº

* **ä»•æ§˜**: ã‚¹ãƒ©ã‚¤ãƒ‰å†…ã«ãƒœã‚¿ãƒ³ã‚’é…ç½®ã—ã€ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ `FR-3` ã§ä½œæˆã—ãŸ API (`/api/hello`) ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€çµæœã‚’ç”»é¢ã«è¡¨ç¤ºã™ã‚‹ã“ã¨ã€‚
* **å—ã‘å…¥ã‚ŒåŸºæº–**:
    * ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯å¾Œã€API ã‹ã‚‰å–å¾—ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆä¾‹: "Hello, Slidev!"ï¼‰ãŒã‚¹ãƒ©ã‚¤ãƒ‰ä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨
    * API é€šä¿¡æ™‚ã« CORS ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãªã„ã“ã¨
    * ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨

### FR-5: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

* **ä»•æ§˜**: APIé€šä¿¡ã‚¨ãƒ©ãƒ¼æ™‚ã®é©åˆ‡ãªå‡¦ç†
* **è¦æ±‚äº‹é …**:
    * ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¡¨ç¤º
    * ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†ï¼ˆ5ç§’ï¼‰
    * ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    * ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³ã®æä¾›
* **å—ã‘å…¥ã‚ŒåŸºæº–**:
    * ã‚¨ãƒ©ãƒ¼æ™‚ã«èµ¤è‰²ã®é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨
    * ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ—¥æœ¬èªã¨è‹±èªã§è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨

-----

## 5. å‹å®šç¾©ä»•æ§˜

### 5.1. å…±æœ‰å‹å®šç¾©
```typescript
// /apps/shared/types/index.ts

export interface ApiResponse<T = any> {
  success: boolean;
  data?: T;
  error?: {
    code: string;
    message: string;
  };
  timestamp: number;
}

export interface HelloResponse {
  message: string;
  timestamp: number;
}

export interface CssSubmitRequest {
  css: string;
  timestamp: number;
}

export interface CssSubmitResponse {
  success: boolean;
  id: string;
  savedAt: number;
}

export interface ErrorResponse {
  error: true;
  message: string;
  code?: string;
  timestamp: number;
}
```

-----

## 6. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä»•æ§˜

### 6.1. CssPlayground.vue
```vue
<!-- /apps/slide/components/CssPlayground.vue -->
<template>
  <div class="css-playground">
    <div class="editor">
      <textarea v-model="cssCode" @input="onCssChange" />
      <div class="controls">
        <button @click="resetCss">ãƒªã‚»ãƒƒãƒˆ</button>
        <button @click="saveCss">ä¿å­˜</button>
      </div>
    </div>
    <div class="preview">
      <iframe ref="previewFrame" :srcdoc="previewHtml" />
    </div>
  </div>
</template>

<script setup lang="ts">
// å®Ÿè£…è©³ç´°ã¯é–‹ç™ºæ™‚ã«è¨˜è¿°
// ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†ã€ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã€APIé€šä¿¡ã‚’å«ã‚€
</script>
```

### 6.2. ApiDemo.vue
```vue
<!-- /apps/slide/components/ApiDemo.vue -->
<template>
  <div class="api-demo">
    <input v-model="name" placeholder="åå‰ã‚’å…¥åŠ›" />
    <button @click="callApi" :disabled="loading">
      {{ loading ? 'é€ä¿¡ä¸­...' : 'APIå‘¼ã³å‡ºã—' }}
    </button>
    <div v-if="response" class="response">
      {{ response }}
    </div>
    <div v-if="error" class="error">
      ã‚¨ãƒ©ãƒ¼: {{ error }}
    </div>
  </div>
</template>

<script setup lang="ts">
// å®Ÿè£…è©³ç´°ã¯é–‹ç™ºæ™‚ã«è¨˜è¿°
// APIé€šä¿¡ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ç®¡ç†ã‚’å«ã‚€
</script>
```

-----

## 7. é–‹ç™ºã‚¹ãƒ†ãƒƒãƒ— (è©³ç´°ç‰ˆ)

### Step 0: å‰ææ¡ä»¶ã®ç¢ºèª
```bash
# å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
node --version  # v20.0.0ä»¥ä¸Š
pnpm --version  # v8.0.0ä»¥ä¸Š

# Cloudflare CLIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install -g wrangler
wrangler login
```

### Step 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸè¨­å®š
```bash
# ãƒªãƒã‚¸ãƒˆãƒªã®ä½œæˆ
mkdir happyo-kun && cd happyo-kun
git init

# pnpmã®åˆæœŸåŒ–ã¨workspaceè¨­å®š
pnpm init
cat > pnpm-workspace.yaml << EOF
packages:
  - 'apps/*'
EOF

# åŸºæœ¬çš„ãªè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
cat > .gitignore << EOF
node_modules
.DS_Store
dist
.env
.env.local
*.log
.slidev
.vite
EOF

# ãƒ«ãƒ¼ãƒˆpackage.jsonã®è¨­å®š
cat > package.json << EOF
{
  "name": "happyo-kun",
  "version": "1.0.0",
  "private": true,
  "description": "ğŸ¯ Your presentation buddy - Interactive slides with live coding powered by Slidev & Cloudflare",
  "scripts": {
    "dev": "pnpm --filter slide dev",
    "build": "pnpm --filter slide build",
    "preview": "pnpm --filter slide preview"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "typescript": "^5.0.0"
  }
}
EOF
```

### Step 2: Slidevãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
```bash
# Slidevã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ
mkdir -p apps/slide
cd apps/slide
pnpm create slidev@latest .
# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ: Default ã‚’é¸æŠ
# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼: pnpm ã‚’é¸æŠ

# è¿½åŠ ã®ä¾å­˜é–¢ä¿‚
pnpm add -D @types/node vite @cloudflare/workers-types

# TypeScriptè¨­å®š
cat > tsconfig.json << EOF
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "moduleResolution": "node",
    "strict": true,
    "jsx": "preserve",
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "types": ["@cloudflare/workers-types"]
  }
}
EOF
```

### Step 3: Pages Functions ã®å®Ÿè£…
```bash
# Functions ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p apps/slide/functions/api

# ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ä½œæˆ
cat > apps/slide/functions/_middleware.ts << 'EOF'
export async function onRequest(context) {
  const response = await context.next();
  response.headers.set(
    "Content-Security-Policy",
    "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';"
  );
  response.headers.set("X-Content-Type-Options", "nosniff");
  response.headers.set("X-Frame-Options", "DENY");
  return response;
}
EOF

# Hello APIã®å®Ÿè£…
cat > apps/slide/functions/api/hello.ts << 'EOF'
export async function onRequestGet(request) {
  const url = new URL(request.url);
  const name = url.searchParams.get('name') || 'World';
  
  return new Response(JSON.stringify({
    message: `Hello, ${name}!`,
    timestamp: Date.now()
  }), {
    headers: {
      'Content-Type': 'application/json',
      'Access-Control-Allow-Origin': '*'
    }
  });
}
EOF
```

### Step 4: å…±æœ‰ã‚³ãƒ¼ãƒ‰ã®è¨­å®š
```bash
# å…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½œæˆ
mkdir -p apps/shared/types apps/shared/utils
cd apps/shared

# package.json
cat > package.json << EOF
{
  "name": "@happyo-kun/shared",
  "version": "1.0.0",
  "private": true,
  "main": "index.js",
  "types": "types/index.ts"
}
EOF

# å‹å®šç¾©ã¯ä¸Šè¨˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³5.1å‚ç…§
```

### Step 5: Viteè¨­å®š
```typescript
// apps/slide/vite.config.ts
import { defineConfig } from 'vite'

export default defineConfig({
  define: {
    __API_URL__: JSON.stringify(
      process.env.NODE_ENV === 'production' 
        ? '/api'
        : 'http://localhost:8788/api'
    )
  },
  slidev: {
    build: {
      out: 'dist'
    }
  }
})
```

-----

## 8. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶

### SR-1: Content Security Policy (CSP)
* **ä»•æ§˜**: XSSæ”»æ’ƒã‚’é˜²ããŸã‚ã®CSPãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š
* **å®Ÿè£…å ´æ‰€**: `/apps/slide/functions/_middleware.ts`ï¼ˆä¸Šè¨˜Step 3å‚ç…§ï¼‰

### SR-2: Rate Limiting
* **ä»•æ§˜**: API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã®éåº¦ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’åˆ¶é™
* **åˆ¶é™**: IPã‚¢ãƒ‰ãƒ¬ã‚¹ã”ã¨ã«1åˆ†é–“100ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ã§
* **å®Ÿè£…ä¾‹**:
```typescript
// functions/api/_rateLimit.ts
const rateLimitMap = new Map();

export async function checkRateLimit(request: Request): Promise<boolean> {
  const ip = request.headers.get('CF-Connecting-IP') || 'unknown';
  const key = `rate_${ip}`;
  const now = Date.now();
  const windowMs = 60 * 1000; // 1åˆ†
  const max = 100;

  const current = rateLimitMap.get(key) || { count: 0, resetTime: now + windowMs };
  
  if (now > current.resetTime) {
    current.count = 0;
    current.resetTime = now + windowMs;
  }
  
  current.count++;
  rateLimitMap.set(key, current);
  
  return current.count <= max;
}
```

### SR-3: å…¥åŠ›ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³
* **ä»•æ§˜**: CSSã‚³ãƒ¼ãƒ‰ã®å±é™ºãªè¦ç´ ã‚’é™¤å»
* **å¯¾è±¡**: `expression()`, `javascript:`, `<script>` ã‚¿ã‚°ãªã©
* **æœ€å¤§é•·**: 100KB

-----

## 9. ãƒ†ã‚¹ãƒˆè¦ä»¶

### T-1: ãƒ­ãƒ¼ã‚«ãƒ«å‹•ä½œç¢ºèª
```bash
# Slidevã®èµ·å‹•
cd apps/slide
pnpm dev
# http://localhost:3030 ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

# åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§Pages Functionsèµ·å‹•
npx wrangler pages dev dist --compatibility-date=2024-01-01
# http://localhost:8788 ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
```

### T-2: ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ
```bash
# ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰
pnpm run build

# ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã®ç¢ºèª
ls -la apps/slide/dist/
# index.html, assets/ ãªã©ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
```

### T-3: APIå‹•ä½œç¢ºèª
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«APIãƒ†ã‚¹ãƒˆ
curl http://localhost:8788/api/hello?name=Test

# æœŸå¾…ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹
# {"message":"Hello, Test!","timestamp":1234567890}
```

### T-4: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå‹•ä½œç¢ºèª
- CssPlaygroundã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ:
    - CSSå…¥åŠ›ã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒæ›´æ–°ã•ã‚Œã‚‹
    - ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã§åˆæœŸçŠ¶æ…‹ã«æˆ»ã‚‹
    - ä¿å­˜ãƒœã‚¿ãƒ³ã§APIã«é€ä¿¡ã•ã‚Œã‚‹
- ApiDemoã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ:
    - åå‰å…¥åŠ›å¾Œã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§APIå‘¼ã³å‡ºã—
    - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    - ã‚¨ãƒ©ãƒ¼æ™‚ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹

-----

## 10. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

| å•é¡Œ | åŸå›  | è§£æ±ºæ–¹æ³• |
|-----|------|---------|
| CORS ã‚¨ãƒ©ãƒ¼ | API URLã®è¨­å®šãƒŸã‚¹ | vite.config.tsã®`__API_URL__`ã‚’ç¢ºèª |
| ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ | Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ | Node.js v20ä»¥ä¸Šã‚’ä½¿ç”¨ |
| Functions 404 | ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€  | functions/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®é…ç½®ã‚’ç¢ºèª |
| pnpm workspace ã‚¨ãƒ©ãƒ¼ | è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å½¢å¼ | pnpm-workspace.yamlã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ç¢ºèª |
| Slidevèµ·å‹•ã‚¨ãƒ©ãƒ¼ | ãƒãƒ¼ãƒˆç«¶åˆ | `--port 3031`ã§ãƒãƒ¼ãƒˆå¤‰æ›´ |
| API timeout | Workersè¨­å®š | wrangler.tomlã®è¨­å®šç¢ºèª |

-----

## 11. ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š

### 11.1. GitHub Actionsè¨­å®š
```yaml
# .github/workflows/deploy.yml
name: Deploy to Cloudflare Pages

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - uses: pnpm/action-setup@v2
        with:
          version: 8
          
      - uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'pnpm'
          
      - run: pnpm install --frozen-lockfile
      
      - run: pnpm run build
      
      - uses: cloudflare/pages-action@v1
        with:
          apiToken: ${{ secrets.CLOUDFLARE_API_TOKEN }}
          accountId: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
          projectName: 'happyo-kun'
          directory: 'apps/slide/dist'
          gitHubToken: ${{ secrets.GITHUB_TOKEN }}
```

### 11.2. Cloudflare Pagesè¨­å®š
Cloudflare Dashboardã§è¨­å®š:
- **ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰**: `pnpm run build`
- **ãƒ“ãƒ«ãƒ‰å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: `apps/slide/dist`
- **ç’°å¢ƒå¤‰æ•°**:
    - `NODE_VERSION`: 20
    - `PNPM_VERSION`: 8

-----

## 12. ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®æ¤œè¨¼

### æ¤œè¨¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] ã‚¹ãƒ©ã‚¤ãƒ‰ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ãƒšãƒ¼ã‚¸é·ç§»ãŒå‹•ä½œã™ã‚‹ï¼ˆçŸ¢å°ã‚­ãƒ¼ã€ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ï¼‰
- [ ] APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ `/api/hello` ãŒå¿œç­”ã™ã‚‹
- [ ] CSSãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãŒå‹•ä½œã™ã‚‹
- [ ] ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã„ãªã„
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ãŒæ©Ÿèƒ½ã—ã¦ã„ã‚‹
- [ ] HTTPSã§é…ä¿¡ã•ã‚Œã¦ã„ã‚‹
- [ ] CSPãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™
- Lighthouse ã‚¹ã‚³ã‚¢: 90ä»¥ä¸Š
- First Contentful Paint: 1.5ç§’ä»¥å†…
- Time to Interactive: 3ç§’ä»¥å†…
- Total Blocking Time: 200msä»¥ä¸‹

-----

## 13. ç’°å¢ƒå¤‰æ•°

### é–‹ç™ºç’°å¢ƒ (.env.local)
```env
VITE_API_URL=http://localhost:8788/api
VITE_APP_NAME=happyo-kun
VITE_ENV=development
```

### æœ¬ç•ªç’°å¢ƒï¼ˆCloudflare Pagesï¼‰
```env
NODE_VERSION=20
PNPM_VERSION=8
```

-----

## 14. README.mdå†…å®¹ä»•æ§˜

```markdown
# ğŸ¯ happyo-kun (ç™ºè¡¨ãã‚“)

> Your presentation buddy - Interactive slides with live coding powered by Slidev & Cloudflare

## âœ¨ Features

- ğŸ“ Markdown-driven slides
- ğŸ¨ Real-time CSS playground
- ğŸš€ Powered by Cloudflare's global network
- ğŸ”§ Interactive API demos
- âš¡ Lightning-fast performance

## ğŸš€ Quick Start

\`\`\`bash
# Clone repository
git clone https://github.com/yourusername/happyo-kun.git
cd happyo-kun

# Install dependencies
pnpm install

# Start development server
pnpm dev

# Build for production
pnpm build
\`\`\`

## ğŸ“š Documentation

See [docs](./docs) for detailed documentation.

## ğŸ“œ License

- System Code: [MIT License](LICENSE)
- Slide Content: See [LICENSE-CONTENT](LICENSE-CONTENT)

## ğŸ¤ Contributing

Contributions are welcome! Please read [CONTRIBUTING.md](CONTRIBUTING.md) first.
```

-----

## 15. (å°†æ¥çš„ãªæ‹¡å¼µ) Web Components

* **æ¦‚è¦**: å°†æ¥çš„ã«ã¯ã€React ã‚„ Angular ã§ä½œæˆã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ Web Components ã¨ã—ã¦ãƒ“ãƒ«ãƒ‰ã—ã€ã‚¹ãƒ©ã‚¤ãƒ‰å†…ã«åŸ‹ã‚è¾¼ã‚ã‚‹ã‚ˆã†ã«æ‹¡å¼µã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
* **ç¾çŠ¶ã®ã‚¿ã‚¹ã‚¯**: ä»Šå›ã®å®Ÿè£…ç¯„å›²ã«ã¯å«ã‚ã¾ã›ã‚“ã€‚ãŸã ã—ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãŒã“ã‚Œã‚’å¦¨ã’ãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ï¼ˆç¾åœ¨ã®Jamstackã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã“ã®è¦ä»¶ã¨äº’æ›æ€§ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚
* **æ‹¡å¼µæ™‚ã®è€ƒæ…®äº‹é …**:
    - `/apps/components/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¿½åŠ 
    - Web Components ã®ãƒ“ãƒ«ãƒ‰ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰
    - Custom Elements ã®ç™»éŒ²å‡¦ç†å®Ÿè£…